import { Link, useLocation, useNavigate } from 'react-router-dom'
import { useAppDispatch, useAppSelector } from '../../hooks/hooks'
import { logout } from '../../store/auth/authSlice'
import styles from './Menu.module.scss'

export const MenuBlock = () => {

    const dispatch = useAppDispatch()

    const AuthRes = useAppSelector((state) => state.auth)
    const UserData = useAppSelector((state) => state.user.data)

    const pathname = useLocation().pathname
    const navigate = useNavigate()

    const onLogout = () => {
        dispatch(logout())
        window.localStorage.removeItem('token')
        navigate('/')
    }

    return (
        <section className={styles.menu}>
            <div className={styles.inner}>
                <div className={styles.user}>
                    <Link to={`/profile/${AuthRes.data?._id}`} className={styles.avatar}>
                        <div></div>
                    </Link>
                    <h3 className={styles.username}>{AuthRes.data?.username}</h3>
                    <h4 className={styles.email}>{AuthRes.data?.email}</h4>
                </div>
                <nav className={styles.nav}>
                    <ul className={styles.list}>
                        <li className={`${styles.item} ${pathname === '/' ? styles.active : ''}`}>
                            <Link to={'/'}>
                                <svg className={styles.icon} width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M13.3333 8V0H24V8H13.3333ZM0 13.3333V0H10.6667V13.3333H0ZM13.3333 24V10.6667H24V24H13.3333ZM0 24V16H10.6667V24H0Z" fill="white" />
                                </svg>
                                Главная
                            </Link>
                            </li>
                        <li className={`${styles.item} ${pathname.slice(0, 9) === '/calendar' && UserData?._id === AuthRes.data?._id ? styles.active : ''}`}>
                            <Link to={`/calendar/${AuthRes.data?._id}`}>
                                <svg className={styles.icon} width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M22.5 2.24525L16.4948 2.24528V0.750176C16.4948 0.335704 16.1591 0 15.7448 0C15.3304 0 14.9948 0.335704 14.9948 0.750176V2.2449H8.99475V0.750176C8.99475 0.335704 8.65913 0 8.24475 0C7.83038 0 7.49475 0.335704 7.49475 0.750176V2.2449H1.5C0.671625 2.2449 0 2.91668 0 3.74525V22.4996C0 23.3282 0.671625 24 1.5 24H22.5C23.3284 24 24 23.3282 24 22.4996V3.74525C24 2.91704 23.3284 2.24525 22.5 2.24525ZM22.5 22.4996H1.5V3.74525H7.49475V4.50106C7.49475 4.9155 7.83038 5.25123 8.24475 5.25123C8.65913 5.25123 8.99475 4.9155 8.99475 4.50106V3.74563H14.9948V4.50143C14.9948 4.9159 15.3304 5.25161 15.7448 5.25161C16.1591 5.25161 16.4948 4.9159 16.4948 4.50143V3.74563H22.5V22.4996ZM17.25 11.9975H18.75C19.164 11.9975 19.5 11.6615 19.5 11.2474V9.74701C19.5 9.33291 19.164 8.99684 18.75 8.99684H17.25C16.836 8.99684 16.5 9.33291 16.5 9.74701V11.2474C16.5 11.6615 16.836 11.9975 17.25 11.9975ZM17.25 17.9986H18.75C19.164 17.9986 19.5 17.6629 19.5 17.2484V15.748C19.5 15.3339 19.164 14.9979 18.75 14.9979H17.25C16.836 14.9979 16.5 15.3339 16.5 15.748V17.2484C16.5 17.6632 16.836 17.9986 17.25 17.9986ZM12.75 14.9979H11.25C10.836 14.9979 10.5 15.3339 10.5 15.748V17.2484C10.5 17.6629 10.836 17.9986 11.25 17.9986H12.75C13.164 17.9986 13.5 17.6629 13.5 17.2484V15.748C13.5 15.3343 13.164 14.9979 12.75 14.9979ZM12.75 8.99684H11.25C10.836 8.99684 10.5 9.33291 10.5 9.74701V11.2474C10.5 11.6615 10.836 11.9975 11.25 11.9975H12.75C13.164 11.9975 13.5 11.6615 13.5 11.2474V9.74701C13.5 9.33254 13.164 8.99684 12.75 8.99684ZM6.75 8.99684H5.25C4.836 8.99684 4.5 9.33291 4.5 9.74701V11.2474C4.5 11.6615 4.836 11.9975 5.25 11.9975H6.75C7.164 11.9975 7.5 11.6615 7.5 11.2474V9.74701C7.5 9.33254 7.164 8.99684 6.75 8.99684ZM6.75 14.9979H5.25C4.836 14.9979 4.5 15.3339 4.5 15.748V17.2484C4.5 17.6629 4.836 17.9986 5.25 17.9986H6.75C7.164 17.9986 7.5 17.6629 7.5 17.2484V15.748C7.5 15.3343 7.164 14.9979 6.75 14.9979Z" fill="#F8F8FB" />
                                </svg>
                                Календарь
                            </Link>
                            </li>
                        <li className={`${styles.item} ${pathname.slice(-4) === 'edit' ? styles.active : ''}`}>
                            <Link to={`/profile/${AuthRes.data?._id}/edit`}>
                                <svg className={styles.icon} width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8.71642 24L8.23881 20.16C7.9801 20.06 7.73612 19.94 7.50687 19.8C7.27761 19.66 7.05393 19.51 6.83582 19.35L3.28358 20.85L0 15.15L3.07463 12.81C3.05473 12.67 3.04478 12.5348 3.04478 12.4044V11.5956C3.04478 11.4652 3.05473 11.33 3.07463 11.19L0 8.85L3.28358 3.15L6.83582 4.65C7.05473 4.49 7.28358 4.34 7.52239 4.2C7.76119 4.06 8 3.94 8.23881 3.84L8.71642 0H15.2836L15.7612 3.84C16.0199 3.94 16.2639 4.06 16.4931 4.2C16.7224 4.34 16.9461 4.49 17.1642 4.65L20.7164 3.15L24 8.85L20.9254 11.19C20.9453 11.33 20.9552 11.4652 20.9552 11.5956V12.4044C20.9552 12.5348 20.9353 12.67 20.8955 12.81L23.9701 15.15L20.6866 20.85L17.1642 19.35C16.9453 19.51 16.7164 19.66 16.4776 19.8C16.2388 19.94 16 20.06 15.7612 20.16L15.2836 24H8.71642ZM12.0597 16.2C13.2139 16.2 14.199 15.79 15.0149 14.97C15.8308 14.15 16.2388 13.16 16.2388 12C16.2388 10.84 15.8308 9.85 15.0149 9.03C14.199 8.21 13.2139 7.8 12.0597 7.8C10.8856 7.8 9.89532 8.21 9.08896 9.03C8.28259 9.85 7.8798 10.84 7.8806 12C7.8806 13.16 8.28338 14.15 9.08896 14.97C9.89453 15.79 10.8848 16.2 12.0597 16.2Z" fill="white" />
                                </svg>
                                Настройки профиля
                            </Link>
                            </li>
                        <li className={`${styles.item} ${pathname === '/help' ? styles.active : ''}`}>
                            <Link to={'/help'}>
                                <svg className={styles.icon} width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M11.94 19.2C12.36 19.2 12.7152 19.0548 13.0056 18.7644C13.296 18.474 13.4408 18.1192 13.44 17.7C13.44 17.28 13.2952 16.9248 13.0056 16.6344C12.716 16.344 12.3608 16.1992 11.94 16.2C11.52 16.2 11.1652 16.3452 10.8756 16.6356C10.586 16.926 10.4408 17.2808 10.44 17.7C10.44 18.12 10.5852 18.4752 10.8756 18.7656C11.166 19.056 11.5208 19.2008 11.94 19.2ZM10.86 14.58H13.08C13.08 13.92 13.1552 13.4 13.3056 13.02C13.456 12.64 13.8808 12.12 14.58 11.46C15.1 10.94 15.51 10.4448 15.81 9.9744C16.11 9.504 16.26 8.9392 16.26 8.28C16.26 7.16 15.85 6.3 15.03 5.7C14.21 5.1 13.24 4.8 12.12 4.8C10.98 4.8 10.0548 5.1 9.3444 5.7C8.634 6.3 8.1392 7.02 7.86 7.86L9.84 8.64C9.94 8.28 10.1652 7.89 10.5156 7.47C10.866 7.05 11.4008 6.84 12.12 6.84C12.76 6.84 13.24 7.0152 13.56 7.3656C13.88 7.716 14.04 8.1008 14.04 8.52C14.04 8.92 13.92 9.2952 13.68 9.6456C13.44 9.996 13.14 10.3208 12.78 10.62C11.9 11.4 11.36 11.99 11.16 12.39C10.96 12.79 10.86 13.52 10.86 14.58ZM12 24C10.34 24 8.78 23.6848 7.32 23.0544C5.86 22.424 4.59 21.5692 3.51 20.49C2.43 19.41 1.5752 18.14 0.9456 16.68C0.316 15.22 0.0008 13.66 0 12C0 10.34 0.3152 8.78 0.9456 7.32C1.576 5.86 2.4308 4.59 3.51 3.51C4.59 2.43 5.86 1.5752 7.32 0.9456C8.78 0.316 10.34 0.0008 12 0C13.66 0 15.22 0.3152 16.68 0.9456C18.14 1.576 19.41 2.4308 20.49 3.51C21.57 4.59 22.4252 5.86 23.0556 7.32C23.686 8.78 24.0008 10.34 24 12C24 13.66 23.6848 15.22 23.0544 16.68C22.424 18.14 21.5692 19.41 20.49 20.49C19.41 21.57 18.14 22.4252 16.68 23.0556C15.22 23.686 13.66 24.0008 12 24Z" fill="white" />
                                </svg>
                                Помощь
                            </Link>
                            </li>
                    </ul>
                </nav>
                <span className={styles.logout} onClick={onLogout}>
                    <svg className={styles.icon} width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18.6667 6.66667L16.8 8.53333L18.9333 10.6667H8V13.3333H18.9333L16.8 15.4667L18.6667 17.3333L24 12L18.6667 6.66667ZM2.66667 2.66667H12V0H2.66667C1.2 0 0 1.2 0 2.66667V21.3333C0 22.8 1.2 24 2.66667 24H12V21.3333H2.66667V2.66667Z" fill="white" />
                    </svg>
                    Выйти из аккаунта
                    </span>
            </div>
        </section>
    )
}
